var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,s=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&o(e,a,t[a]);if(n)for(var a of n(t))l.call(t,a)&&o(e,a,t[a]);return e},i=(e,n)=>t(e,a(n)),u=(e,t,a)=>(o(e,"symbol"!=typeof t?t+"":t,a),a),c=(e,t,a)=>new Promise(((n,r)=>{var l=e=>{try{s(a.next(e))}catch(t){r(t)}},o=e=>{try{s(a.throw(e))}catch(t){r(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(l,o);s((a=a.apply(e,t)).next())}));import{c as m,p as d,R as p,C as g,A as b,B as E,m as h,r as v,o as f,a as y,b as q,g as k,d as x,e as C,f as S,h as w,i as D,j as P,s as j,k as J,l as $,n as I,L as N,q as O,t as M,u as _,v as z,T as B,w as T,x as F,y as Q,z as L,D as W,E as A,F as R,G as V,H as G,I as H,J as K,K as Y,M as U,N as X,O as Z,P as ee,Q as te,S as ae,U as ne,V as re,W as le,X as oe,Y as se,Z as ie,_ as ue,$ as ce,a0 as me,a1 as de,a2 as pe,a3 as ge,a4 as be,a5 as Ee,a6 as he,a7 as ve,a8 as fe,a9 as ye,aa as qe,ab as ke,ac as xe,ad as Ce,ae as Se,af as we,ag as De,ah as Pe,ai as je,aj as Je,ak as $e,al as Ie,am as Ne,an as Oe,ao as Me,ap as _e,aq as ze,ar as Be,as as Te,at as Fe,au as Qe,av as Le,aw as We,ax as Ae,ay as Re,az as Ve,aA as Ge,aB as He,aC as Ke,aD as Ye,aE as Ue,aF as Xe,aG as Ze,aH as et,aI as tt,aJ as at,aK as nt,aL as rt,aM as lt,aN as ot,aO as st,aP as it,aQ as ut,aR as ct,aS as mt,aT as dt,aU as pt,aV as gt,aW as bt,aX as Et,aY as ht,aZ as vt,a_ as ft,a$ as yt,b0 as qt,b1 as kt,b2 as xt,b3 as Ct,b4 as St,b5 as wt,b6 as Dt,b7 as Pt,b8 as jt,b9 as Jt,ba as $t,bb as It,bc as Nt,bd as Ot,be as Mt,bf as _t,bg as zt,bh as Bt,bi as Tt,bj as Ft,bk as Qt,bl as Lt,bm as Wt,bn as At,bo as Rt,bp as Vt}from"./vendor.0707d97d.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Gt={drawerWidth:260,maxDrawerWidth:window.innerWidth/2,modalWidth:500},Ht="bull_monitor:",Kt=Ht+"store:",Yt=Ht+"atoms:",Ut=Ht+"hide_tip:",Xt=m(d((e=>({isOpen:!1,defaultWidth:Gt.drawerWidth,changeDefaultWidth:t=>e({defaultWidth:t}),toggle:()=>e((({isOpen:e})=>({isOpen:!e}))),close:()=>e({isOpen:!1}),open:()=>e({isOpen:!0})})),{name:`${Kt}drawer`}));function Zt(e){var t=e,{centered:a}=t,o=((e,t)=>{var a={};for(var o in e)r.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&n)for(var o of n(e))t.indexOf(o)<0&&l.call(e,o)&&(a[o]=e[o]);return a})(t,["centered"]);return a?p.createElement("div",{style:{display:"flex",justifyContent:"center",margin:"20px 0"}},p.createElement(g,s({},o))):p.createElement(g,s({},o))}function ea({refetch:e,message:t="There was an error during request."}){return p.createElement(b,{severity:"error",action:p.createElement(E,{onClick:()=>e(),color:"inherit",size:"small"},"Refetch")},t)}const ta=h({spin:{margin:"25px 0"}}),aa=e=>{const t=ta();return"loading"===e.status?p.createElement(Zt,{centered:!0,className:t.spin}):"error"===e.status?p.createElement(ea,{message:(a=e.error,null==(l=null==(r=null==(n=null==a?void 0:a.response)?void 0:n.errors)?void 0:r[0])?void 0:l.message),refetch:e.refetch}):p.createElement(p.Fragment,null,e.children);var a,n,r,l},na=m(d((e=>({name:"",changeName:t=>e({name:t})})),{name:`${Kt}queues-filter`}));var ra,la,oa,sa,ia,ua,ca,ma;(la=ra||(ra={})).Completed="completed",la.Waiting="waiting",la.Active="active",la.Delayed="delayed",la.Failed="failed",la.Paused="paused",la.Stuck="stuck",la.Unknown="unknown",la.Prioritized="prioritized",(sa=oa||(oa={})).Completed="completed",sa.Wait="wait",sa.Active="active",sa.Delayed="delayed",sa.Failed="failed",sa.Paused="paused",(ua=ia||(ia={})).Asc="ASC",ua.Desc="DESC",(ma=ca||(ca={})).Bull="bull",ma.Bullmq="bullmq";const da=[null,...Object.values(ra).filter((e=>"stuck"!==e))],pa=m(d((e=>({field:null,changeField:t=>e({field:t})})),{name:`${Kt}queues-sort`})),ga={[ra.Failed]:q[500],[ra.Completed]:k[500],[ra.Delayed]:x[800],[ra.Waiting]:C[500],[ra.Paused]:S[600],[ra.Active]:w[500],[ra.Stuck]:S[400],[ra.Unknown]:S[300]},ba=()=>ga;function Ea(e){const t=(a=e.status,ga[a]);var a;return p.createElement(D,{style:{color:"#fff",backgroundColor:t},size:e.size,className:e.className,label:P(e.label)?e.status:e.label})}const ha=(e,t,a)=>((e,t,a,n,r)=>(r-n)/(a-t)*(e-t)+n)(e,t,a,0,100),va=h((e=>({root:{display:"flex",height:3,overflow:"hidden",marginTop:e.spacing(.5)}})));function fa({count:e}){const t=va(),a=ba(),n=v.exports.useMemo((()=>{const t=j(e.map((({count:e})=>e)));return t?e.map((({count:e,status:n})=>({width:ha(e,0,t)+"%",color:a[n]}))):null}),[a,e]);return n?p.createElement("div",{className:t.root},n.map((({width:e,color:t},a)=>p.createElement("div",{style:{width:e,backgroundColor:t},key:a})))):null}const ya=h({root:{position:"relative"},list:{display:"flex",flexWrap:"wrap",alignItems:"center",listStyleType:"none",padding:0,"& li":{margin:"0 2px 2px 0","& div":{cursor:"pointer"}}}});function qa(e){const t=ya();return p.createElement("div",{className:t.root},p.createElement("ul",{className:t.list},e.count.map((({status:e,count:t},a)=>p.createElement("li",{"data-status":e,key:a,title:e},p.createElement(Ea,{size:"small",status:e,label:t}))))),p.createElement(fa,{count:e.count}))}const ka=m(d((e=>({confirmDangerousActions:!0,groupQueuesByPrefix:!1,expandJobData:!1,expandJobReturnValue:!1,expandJobStackTrace:!1,changeConfirmDangerousActions:t=>e({confirmDangerousActions:t}),toggleConfirmDangerousActions:()=>e((e=>({confirmDangerousActions:!e.confirmDangerousActions}))),toggleGroupQueuesByPrefix:()=>e((e=>({groupQueuesByPrefix:!e.groupQueuesByPrefix}))),toggleExpandJobData:()=>e((e=>({expandJobData:!e.expandJobData}))),toggleExpandJobReturnValue:()=>e((e=>({expandJobReturnValue:!e.expandJobReturnValue}))),toggleExpandJobStackTrace:()=>e((e=>({expandJobStackTrace:!e.expandJobStackTrace})))})),{name:`${Kt}prefs`,version:3})),xa=h((e=>({listItem:{position:"relative",paddingRight:e.spacing(1),"& .MuiListItemIcon-root":{minWidth:32}}})));var Ca=v.exports.memo((e=>{const t=xa(),a=(n=e.queue).keyPrefix&&"bull"!==n.keyPrefix?n.keyPrefix+" "+n.name:n.name;var n;const{id:r,isPaused:l,readonly:o}=e.queue,s=v.exports.useCallback((t=>{const n=t.target,l=null==n?void 0:n.closest("[data-status]");let o=null;l&&(o=l.dataset.status),e.onSelect(r,a,o)}),[r,a]),i=(u=e.queue.jobsCounts,v.exports.useMemo((()=>Object.entries(J(u,I)).map((([e,t])=>({status:e,count:t})))),[u]));var u;return p.createElement(N,{onClick:s,selected:e.isSelected,className:t.listItem,dense:!0,button:!0},(o||l)&&p.createElement(O,null,p.createElement(O,{title:l?"Paused":"Readonly"},l?p.createElement(M,null):p.createElement(_,null))),p.createElement(z,{disableTypography:!0,primary:p.createElement(B,{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}},e.queue.name),secondary:p.createElement(qa,{count:i})}))}));const Sa={maybeStringify(e,t=2){if(e&&"object"==typeof e)try{return JSON.stringify(e,null,t)}catch(a){return e}return e},maybeParse(e){if(e&&"string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e}};function wa(e,t){const a=T((()=>{try{return Sa.maybeParse(localStorage.getItem(e))||t}catch(a){return t}})());return T((e=>e(a)),((t,n,r)=>{const l="function"==typeof r?r(t(a)):r;n(a,l),localStorage.setItem(e,Sa.maybeStringify(l))}))}const Da=20,Pa=wa(`${Yt}wsIdV2`,null),ja=wa(`${Yt}wsListV2`,[]),Ja=F(ja,(e=>e.length)),$a=R((e=>T((t=>{const a=t(ja);return e&&a&&a.find((t=>t.id===e))||null})))),Ia=T((e=>e($a(e(Pa)))),((e,t,a)=>{const n=e(ja),r=e(Pa),l=n.map((e=>e.id===r?s(s({},e),a):e));t(ja,l)})),Na=T((e=>{var t,a;return null!=(a=null==(t=e(Ia))?void 0:t.page)?a:0}),((e,t,a)=>{t(Ia,{page:a})})),Oa=T((e=>{var t,a;return null!=(a=null==(t=e(Ia))?void 0:t.queue)?a:null}),((e,t,a)=>{t(Ia,{queue:a,page:0})})),Ma=T((e=>{var t,a;return null!=(a=null==(t=e(Ia))?void 0:t.queueLabel)?a:null}),((e,t,a)=>{t(Ia,{queueLabel:a,page:0})})),_a=T((e=>{var t,a;return null!=(a=null==(t=e(Ia))?void 0:t.status)?a:ra.Active}),((e,t,a)=>{t(Ia,{status:a,page:0})})),za=T((e=>{var t,a;return null!=(a=null==(t=e(Ia))?void 0:t.order)?a:ia.Asc}),((e,t,a)=>{t(Ia,{order:a,page:0})})),Ba=T((e=>{var t,a;return null!=(a=null==(t=e(Ia))?void 0:t.jobId)?a:""}),((e,t,a)=>{t(Ia,{jobId:a,page:0})})),Ta=T((e=>{var t,a;return null!=(a=null==(t=e(Ia))?void 0:t.dataSearch)?a:""}),((e,t,a)=>{t(Ia,{dataSearch:a,page:0})})),Fa=T(null,((e,t,a)=>{if(!a.queue||!a.queueLabel)return;const n=i(s({id:Q()},a),{queue:a.queue,queueLabel:a.queueLabel}),r=e(ja);r.length>=Da?t(ja,L(r).concat(n)):t(ja,[...r,n]),t(Pa,n.id)})),Qa=T(null,((e,t)=>{t(Ia,{dataSearch:""})})),La=T(null,((e,t,a)=>{const n=e(ja),r=e(Pa),l=n.findIndex((e=>e.id===a));if(-1!==l){if(W(n,l),t(ja,[...n]),A(n))return t(Pa,null);if(r===a){const e=n[l]||n[l+1]||n[l-1];e&&t(Pa,e.id)}}}));function Wa({queues:e}){const t=(e=>ka((e=>e.groupQueuesByPrefix))?$(e,"keyPrefix"):null)(e),[a,n]=V(Oa),r=G(Ma),l=G(_a),o=Xt((e=>e.close)),s=v.exports.useCallback(((e,t,a)=>{n(e),r(t),a&&l(a),o()}),[]),i=e=>p.createElement(Ca,{onSelect:s,isSelected:a===e.id,key:e.id,queue:e});return t?p.createElement(p.Fragment,null,Object.entries(t).map((([e,t])=>p.createElement(H,{key:e,subheader:p.createElement(K,null,e)},t.map(i))))):p.createElement(H,null,e.map(i))}function Aa(e){const{name:t,changeName:a}=na(),n=v.exports.useCallback((e=>{a(e.target.value)}),[]);return p.createElement(Y,{className:e.className,onChange:n,value:t,id:"queues-filter-name",label:"Filter",size:"small",variant:"outlined"})}function Ra(e){const[t,a]=p.useState(null),{field:n,changeField:r}=pa(),l=()=>a(null);return p.createElement(p.Fragment,null,p.createElement(U,{title:"Sort"},p.createElement(X,{"aria-controls":"queues-sort-menu","aria-haspopup":"true",className:e.className,onClick:e=>a(e.currentTarget),size:"large"},p.createElement(Z,null))),p.createElement(ee,{anchorEl:t,onClose:l,open:Boolean(t),id:"queues-sort-menu"},da.map((e=>p.createElement(te,{selected:e===n,key:e,onClick:()=>{r(e),l()}},e?e+" ⬇️":"none")))))}const Va="queues",Ga="job-data",Ha="job-logs",Ka="jobs-list",Ya="redis-info",Ua="metrics",Xa={dev:!1,demo:true,useMocks:true},{pathname:Za}=window.location,en={endpoint:(Za.endsWith("/")?Za.slice(0,-1):Za)+"/graphql"},tn=new ae.GraphQLClient(en.endpoint),an=ne(Object.values(ra),ra.Stuck);const nn=new class{constructor(){u(this,"queues",[]),u(this,"jobs",[]);{const{queues:e,jobs:t}=(()=>{const e=re(10).map((e=>({id:Q(),name:`queue:${e}`,isPaused:!1,keyPrefix:"bull"})));return{jobs:re(100).map((t=>{var a;const n=le(an),r=n===ra.Delayed?1e5:0,l=(new Date).getTime(),o=n===ra.Completed||n===ra.Failed,s=o||n===ra.Active;return{id:String(oe(0,1e6)),queue:null==(a=le(e))?void 0:a.id,status:n,progress:"0",attemptsMade:0,returnValue:n===ra.Completed?"some return value":null,failedReason:n===ra.Failed?"some failed reason":null,processedOn:s?l:null,finishedOn:o?l:null,delay:r,timestamp:l,name:"__default__",opts:JSON.stringify({timestamp:l,delay:r},null,2),stacktrace:[],data:`{"key": "value-${t}"}`,logs:{count:0,logs:["some log"]}}})),queues:e}})();this.queues=e,this.jobs=t}}findJob(e,t){return this.jobs.find((a=>a.id==t&&a.queue===e))}findQueue(e){return this.queues.find((({id:t})=>e===t))}},rn=ae.gql`
  fragment CommonJobFields on Job {
    id
    progress
    attemptsMade
    failedReason
    status
    stacktrace
    timestamp
    returnValue
    finishedOn
    processedOn
    processingTime
    name
    opts
    delay
  }
`,ln=()=>oe(0,50);let on=null;const{useMocks:sn}=Xa,un={mutations:{createJob:sn?({input:e})=>{const t={queue:e.queue,name:e.name,id:String(oe(0,1e6)),data:e.data,status:ra.Waiting,attemptsMade:0,opts:e.options,stacktrace:[],timestamp:(new Date).getTime(),logs:{count:0,logs:[]}};return nn.jobs.unshift(t),Promise.resolve({createJob:t})}:e=>tn.request(ae.gql`
      mutation CreateJob($input: CreateJobInput!) {
        createJob(input: $input) {
          id
        }
      }
    `,e),createJobLog:sn?e=>{const t=nn.findJob(e.queue,e.id);return t&&(t.logs.logs.push(e.row),t.logs.count+=1),Promise.resolve({log:t})}:e=>tn.request(ae.gql`
      mutation CreateJobLog($queue: ID!, $id: ID!, $row: String!) {
        log(queue: $queue, id: $id, row: $row) {
          id
        }
      }
    `,e),discardJob:sn?e=>Promise.resolve({discardJob:nn.findJob(e.queue,e.id)}):e=>tn.request(ae.gql`
      mutation DiscardJob($queue: ID!, $id: ID!) {
        discardJob(queue: $queue, id: $id) {
          id
        }
      }
    `,e),moveJobToCompleted:sn?e=>{const t=nn.findJob(e.queue,e.id);return t&&(t.status=ra.Completed),Promise.resolve({moveJobToCompleted:t})}:e=>tn.request(ae.gql`
      mutation MoveJobToCompleted($queue: ID!, $id: ID!) {
        moveJobToCompleted(queue: $queue, id: $id) {
          id
        }
      }
    `,e),moveJobToFailed:sn?e=>{const t=nn.findJob(e.queue,e.id);return t&&(t.status=ra.Failed),Promise.resolve({moveJobToFailed:t})}:e=>tn.request(ae.gql`
      mutation MoveJobToFailed($queue: ID!, $id: ID!) {
        moveJobToFailed(queue: $queue, id: $id) {
          id
        }
      }
    `,e),promoteJob:sn?e=>{const t=nn.findJob(e.queue,e.id);return t&&(t.status=ra.Waiting),Promise.resolve({promoteJob:t})}:e=>tn.request(ae.gql`
      mutation PromoteJob($queue: ID!, $id: ID!) {
        promoteJob(queue: $queue, id: $id) {
          id
        }
      }
    `,e),removeJob:sn?e=>{let t;return nn.jobs=nn.jobs.filter((a=>{const n=a.id===e.id&&a.queue===e.queue;return n&&(t=n),!Boolean(n)})),Promise.resolve({removeJob:t})}:e=>tn.request(ae.gql`
      mutation RemoveJob($queue: ID!, $id: ID!) {
        removeJob(queue: $queue, id: $id) {
          id
        }
      }
    `,e),retryJob:sn?e=>Promise.resolve({retryJob:nn.findJob(e.queue,e.id)}):e=>tn.request(ae.gql`
      mutation RetryJob($queue: ID!, $id: ID!) {
        retryJob(queue: $queue, id: $id) {
          id
        }
      }
    `,e),updateJobData:sn?e=>{const t=nn.findJob(e.queue,e.id);return t&&(t.data=e.data),Promise.resolve({updateJobData:t})}:e=>tn.request(ae.gql`
      mutation UpdateJobData($queue: ID!, $id: ID!, $data: JSON) {
        updateJobData(queue: $queue, id: $id, data: $data) {
          id
        }
      }
    `,e),pauseQueue:sn?e=>{const t=nn.findQueue(e.queue);return t&&(t.isPaused=!0),nn.jobs=nn.jobs.map((t=>t.queue===e.queue&&[ra.Active,ra.Waiting,ra.Delayed].includes(t.status)?i(s({},t),{status:ra.Paused}):t)),Promise.resolve({pauseQueue:t})}:e=>tn.request(ae.gql`
      mutation PauseQueue($queue: ID!) {
        pauseQueue(queue: $queue) {
          name
        }
      }
    `,e),resumeQueue:sn?e=>{const t=nn.findQueue(e.queue);return t&&(t.isPaused=!1),Promise.resolve({resumeQueue:t})}:e=>tn.request(ae.gql`
      mutation ResumeQueue($queue: ID!) {
        resumeQueue(queue: $queue) {
          name
        }
      }
    `,e),emptyQueue:sn?e=>{const t=nn.findQueue(e.queue);return nn.jobs=nn.jobs.filter((t=>t.queue!==e.queue&&t.status!==ra.Waiting&&t.status!==ra.Delayed)),Promise.resolve({emptyQueue:t})}:e=>tn.request(ae.gql`
      mutation EmptyQueue($queue: ID!) {
        emptyQueue(queue: $queue) {
          name
        }
      }
    `,e),closeQueue:sn?e=>{const t=nn.findQueue(e.queue);return Promise.resolve({closeQueue:t})}:e=>tn.request(ae.gql`
      mutation CloseQueue($queue: ID!) {
        closeQueue(queue: $queue) {
          name
        }
      }
    `,e),removeJobsByPattern:sn?e=>{const t=new RegExp(e.pattern);return nn.jobs=nn.jobs.filter((a=>a.queue!==e.queue&&!t.test(String(a.id)))),Promise.resolve({removeJobsByPattern:!0})}:e=>tn.request(ae.gql`
      mutation RemoveJobsByPattern($queue: ID!, $pattern: String!) {
        removeJobsByPattern(queue: $queue, pattern: $pattern)
      }
    `,e),cleanQueue:sn?e=>(nn.jobs=nn.jobs.filter((t=>t.queue!==e.queue||t.status!==(e.status===oa.Wait?ra.Waiting:e.status))),Promise.resolve({cleanQueue:[]})):e=>tn.request(ae.gql`
      mutation CleanQueue($queue: ID!, $status: JobStatusClean!) {
        cleanQueue(queue: $queue, status: $status)
      }
    `,e),retryJobs:sn?()=>Promise.resolve({retryJobs:[]}):e=>tn.request(ae.gql`
      mutation RetryJobs($queue: ID!, $jobs: [ID!]!) {
        retryJobs(queue: $queue, jobs: $jobs) {
          id
        }
      }
    `,e),removeJobs:sn?e=>{const t=[];return nn.jobs=nn.jobs.filter((a=>{const n=e.jobs.includes(a.id)&&a.queue===e.queue;return n&&t.push(n),!Boolean(n)})),Promise.resolve({removeJobs:t})}:e=>tn.request(ae.gql`
      mutation RemoveJobs($queue: ID!, $jobs: [ID!]!) {
        removeJobs(queue: $queue, jobs: $jobs) {
          id
        }
      }
    `,e),clearMetrics:sn?()=>Promise.resolve({clearMetrics:!0}):e=>tn.request(ae.gql`
      mutation ClearMetrics($queue: ID!) {
        clearMetrics(queue: $queue)
      }
    `,e),clearAllMetrics:sn?()=>Promise.resolve({clearAllMetrics:!0}):()=>tn.request(ae.gql`
      mutation ClearAllMetrics {
        clearAllMetrics
      }
    `)},queries:{getJobsForExport:sn?e=>Promise.resolve({jobs:nn.jobs.filter((t=>{var a;return t.queue===e.queue&&(!e.ids||(null==(a=e.ids)?void 0:a.includes(t.id)))}))}):e=>tn.request(ae.gql`
      query GetJobsForExport(
        $queue: ID!
        $ids: [ID]
        $status: JobStatus
        $id: ID
        $dataSearch: String
      ) {
        jobs(
          queue: $queue
          ids: $ids
          status: $status
          id: $id
          dataSearch: $dataSearch
          offset: 0
          limit: 100000
        ) {
          id
          progress
          attemptsMade
          failedReason
          status
          stacktrace
          timestamp
          returnValue
          finishedOn
          processedOn
          name
          opts
          data
          logs {
            count
            logs
          }
        }
      }
    `,e),getRedisInfo:sn?()=>Promise.resolve({redisInfo:{blocked_clients:"1",connected_clients:"7",mem_fragmentation_ratio:"2.69",os:"Linux 5.8.0-50-generic x86_64",redis_mode:"standalone",redis_version:"5.0.4",tcp_port:"6379",total_system_memory_human:"7.74G",uptime_in_seconds:"112",used_cpu_sys:"0.134950",used_memory_human:"1.04M",used_memory_peak_human:"1.20M"}}):()=>tn.request(ae.gql`
      query GetRedisInfo {
        redisInfo {
          redis_version
          redis_mode
          used_memory_human
          used_memory_peak_human
          total_system_memory_human
          connected_clients
          blocked_clients
          mem_fragmentation_ratio
          os
          uptime_in_seconds
          used_cpu_sys
          tcp_port
        }
      }
    `),getJobData:sn?e=>Promise.resolve({job:nn.jobs.find((t=>t.queue===e.queue&&t.id===e.id))}):e=>tn.request(ae.gql`
      query GetJobData($queue: ID!, $id: ID!) {
        job(queue: $queue, id: $id) {
          data
        }
      }
    `,e),getJobLogs:sn?e=>Promise.resolve({job:nn.jobs.find((t=>t.queue===e.queue&&t.id===e.id))}):e=>tn.request(ae.gql`
      query GetJobLogs($queue: ID!, $id: ID!) {
        job(queue: $queue, id: $id) {
          logs {
            logs
            count
          }
        }
      }
    `,e),getJobs:sn?({queue:e,status:t,offset:a=0,limit:n=20,id:r})=>{if(r){const t=nn.jobs.find((t=>t.queue===e&&t.id===r));return Promise.resolve({jobs:t?[t]:[]})}const l=nn.jobs.filter((a=>a.queue===e&&t===a.status)).slice(a,a+n-1);return Promise.resolve({jobs:l})}:e=>tn.request(ae.gql`
      ${rn}
      query GetJobs(
        $queue: ID!
        $offset: Int
        $limit: Int
        $status: JobStatus
        $order: OrderEnum
        $id: ID
        $dataSearch: String
        $fetchData: Boolean!
      ) {
        jobs(
          queue: $queue
          offset: $offset
          limit: $limit
          status: $status
          order: $order
          id: $id
          dataSearch: $dataSearch
        ) {
          ...CommonJobFields
          data @include(if: $fetchData)
        }
      }
    `,e),getJobById:sn?e=>{const t=nn.jobs.find((t=>t.queue===e.queue&&t.id===e.id));return Promise.resolve({job:t})}:e=>tn.request(ae.gql`
      ${rn}
      query GetJobById($queue: ID!, $id: ID!) {
        job(queue: $queue, id: $id) {
          ...CommonJobFields
        }
      }
    `,e),getQueues:sn?()=>Promise.resolve({queues:nn.queues.map((e=>({id:e.id,provider:ca.Bull,name:e.name,isPaused:e.isPaused,keyPrefix:e.keyPrefix,jobsCounts:nn.jobs.reduce(((t,a)=>(a.queue===e.id&&(t[a.status]+=1),t)),{waiting:0,active:0,completed:0,failed:0,delayed:0,paused:0,prioritized:0,unknown:0})})))}):()=>tn.request(ae.gql`
      query GetQueues {
        queues {
          id
          provider
          readonly
          name
          keyPrefix
          isPaused
          jobsCounts {
            waiting
            active
            completed
            failed
            delayed
            paused
            prioritized
          }
        }
      }
    `),getQueueMetrics:sn?()=>c(this,null,(function*(){return on||(on=(()=>{const e=Date.now();return{metrics:re(25).map((t=>({timestamp:e+1e5*t,queue:"lul",counts:{waiting:ln(),completed:ln(),failed:ln(),paused:0,active:ln(),delayed:ln()}})))}})(),on)})):e=>tn.request(ae.gql`
      query GetQueueMetrics($queue: ID!, $start: Int, $end: Int) {
        metrics(queue: $queue, start: $start, end: $end) {
          timestamp
          processingTime
          processingTimeMin
          processingTimeMax
          counts {
            waiting
            active
            completed
            failed
            delayed
            paused
          }
        }
      }
    `,e)}},cn=p.createContext(un),mn=e=>p.createElement(cn.Provider,{value:un},e.children),dn=()=>p.useContext(cn),pn=m(d((e=>({shouldFetchData:!0,pollingInterval:5e3,textSearchPollingDisabled:!0,changePollingInterval:t=>e({pollingInterval:t}),toggleTextSearchPollingDisabled:()=>e((({textSearchPollingDisabled:t})=>e({textSearchPollingDisabled:!t}))),toggleShouldFetchData:()=>e((({shouldFetchData:e})=>({shouldFetchData:!e})))})),{name:`${Kt}network`,version:1})),gn=()=>{const e=pn((e=>e.pollingInterval));return e||!1},bn=p.createContext(null),En=e=>{const{queries:t}=dn(),a=gn(),n=se(Va,t.getQueues,{refetchInterval:a});return p.createElement(bn.Provider,{value:n},e.children)},hn=()=>p.useContext(bn),vn=h((e=>({drawer:{width:"auto",position:"relative",[e.breakpoints.up("md")]:{width:"var(--drawer-width)",flexShrink:0}},toolbar:i(s({},e.mixins.toolbar),{display:"flex",alignItems:"center"}),utils:{display:"flex",marginTop:e.spacing(1),marginLeft:e.spacing(.5),marginRight:e.spacing(.5),alignItems:"center"},filter:{flex:1},dragger:{width:4,cursor:"ew-resize",position:"absolute",top:0,right:-4,bottom:0,zIndex:1201}})));function fn(){const{data:e,status:t,refetch:a,error:n}=hn(),r=vn(),l=ie(),o=ue(l.breakpoints.up("md")),[s,i]=Xt((e=>[e.isOpen,e.close]),ce),{onMouseDown:u}=(()=>{const e=Xt((e=>e.changeDefaultWidth));return v.exports.useMemo((()=>{const t=document.body,a=t=>{const a=y(t.clientX,Gt.drawerWidth,Gt.maxDrawerWidth);e(a)},n=()=>{t.classList.remove("resizing-drawer"),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",n)};return{onMouseDown:()=>{t.classList.add("resizing-drawer"),document.addEventListener("mousemove",a),document.addEventListener("mouseup",n)}}}),[])})(),c=null==e?void 0:e.queues,m=(e=>{const t=pa((e=>e.field));return v.exports.useMemo((()=>e&&t?f(e,"jobsCounts."+t,"desc"):e),[e,t])})((e=>{const t=na((e=>e.name));return v.exports.useMemo((()=>{if(!e||!t)return e;const a=t.toLowerCase();return e.filter((({name:e})=>e.toLowerCase().includes(a)))}),[t,e])})(c));return p.createElement("nav",{className:r.drawer},p.createElement("div",{onMouseDown:u,className:r.dragger}),p.createElement(me,{open:o||s,container:o?void 0:document.querySelector("main"),variant:o?"permanent":"temporary",onClose:i,anchor:"rtl"===l.direction?"right":"left",PaperProps:{style:{width:o?"var(--drawer-width)":Gt.drawerWidth+"px"}}},p.createElement("div",{className:r.toolbar},p.createElement(X,{onClick:i,size:"large"},"ltr"===l.direction?p.createElement(de,null):p.createElement(pe,null))),p.createElement(aa,{error:n,status:t,refetch:a},A(c)?p.createElement(b,{severity:"error"},"No queues"):p.createElement(p.Fragment,null,p.createElement("div",{className:r.utils},p.createElement(Aa,{className:r.filter}),p.createElement(Ra,null)),m&&p.createElement(Wa,{queues:m})))))}const yn=m((e=>({isOpen:!1,open:()=>e({isOpen:!0}),close:()=>e({isOpen:!1})}))),qn=m((e=>({isOpen:!1,open:()=>e({isOpen:!0}),close:()=>e({isOpen:!1})}))),kn=e=>p.createElement("svg",s({width:"256",viewBox:"0 0 256 220",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMin meet"},e),p.createElement("path",{d:"M245.97 168.943c-13.662 7.121-84.434 36.22-99.501 44.075-15.067 7.856-23.437 7.78-35.34 2.09-11.902-5.69-87.216-36.112-100.783-42.597C3.566 169.271 0 166.535 0 163.951v-25.876s98.05-21.345 113.879-27.024c15.828-5.679 21.32-5.884 34.79-.95 13.472 4.936 94.018 19.468 107.331 24.344l-.006 25.51c.002 2.558-3.07 5.364-10.024 8.988",fill:"#912626"}),p.createElement("path",{d:"M245.965 143.22c-13.661 7.118-84.431 36.218-99.498 44.072-15.066 7.857-23.436 7.78-35.338 2.09-11.903-5.686-87.214-36.113-100.78-42.594-13.566-6.485-13.85-10.948-.524-16.166 13.326-5.22 88.224-34.605 104.055-40.284 15.828-5.677 21.319-5.884 34.789-.948 13.471 4.934 83.819 32.935 97.13 37.81 13.316 4.881 13.827 8.9.166 16.02",fill:"#C6302B"}),p.createElement("path",{d:"M245.97 127.074c-13.662 7.122-84.434 36.22-99.501 44.078-15.067 7.853-23.437 7.777-35.34 2.087-11.903-5.687-87.216-36.112-100.783-42.597C3.566 127.402 0 124.67 0 122.085V96.206s98.05-21.344 113.879-27.023c15.828-5.679 21.32-5.885 34.79-.95C162.142 73.168 242.688 87.697 256 92.574l-.006 25.513c.002 2.557-3.07 5.363-10.024 8.987",fill:"#912626"}),p.createElement("path",{d:"M245.965 101.351c-13.661 7.12-84.431 36.218-99.498 44.075-15.066 7.854-23.436 7.777-35.338 2.087-11.903-5.686-87.214-36.112-100.78-42.594-13.566-6.483-13.85-10.947-.524-16.167C23.151 83.535 98.05 54.148 113.88 48.47c15.828-5.678 21.319-5.884 34.789-.949 13.471 4.934 83.819 32.933 97.13 37.81 13.316 4.88 13.827 8.9.166 16.02",fill:"#C6302B"}),p.createElement("path",{d:"M245.97 83.653c-13.662 7.12-84.434 36.22-99.501 44.078-15.067 7.854-23.437 7.777-35.34 2.087-11.903-5.687-87.216-36.113-100.783-42.595C3.566 83.98 0 81.247 0 78.665v-25.88s98.05-21.343 113.879-27.021c15.828-5.68 21.32-5.884 34.79-.95C162.142 29.749 242.688 44.278 256 49.155l-.006 25.512c.002 2.555-3.07 5.361-10.024 8.986",fill:"#912626"}),p.createElement("path",{d:"M245.965 57.93c-13.661 7.12-84.431 36.22-99.498 44.074-15.066 7.854-23.436 7.777-35.338 2.09C99.227 98.404 23.915 67.98 10.35 61.497-3.217 55.015-3.5 50.55 9.825 45.331 23.151 40.113 98.05 10.73 113.88 5.05c15.828-5.679 21.319-5.883 34.789-.948 13.471 4.935 83.819 32.934 97.13 37.811 13.316 4.876 13.827 8.897.166 16.017",fill:"#C6302B"}),p.createElement("path",{d:"M159.283 32.757l-22.01 2.285-4.927 11.856-7.958-13.23-25.415-2.284 18.964-6.839-5.69-10.498 17.755 6.944 16.738-5.48-4.524 10.855 17.067 6.391M131.032 90.275L89.955 73.238l58.86-9.035-17.783 26.072M74.082 39.347c17.375 0 31.46 5.46 31.46 12.194 0 6.736-14.085 12.195-31.46 12.195s-31.46-5.46-31.46-12.195c0-6.734 14.085-12.194 31.46-12.194",fill:"#FFF"}),p.createElement("path",{d:"M185.295 35.998l34.836 13.766-34.806 13.753-.03-27.52",fill:"#621B1C"}),p.createElement("path",{d:"M146.755 51.243l38.54-15.245.03 27.519-3.779 1.478-34.791-13.752",fill:"#9A2928"})),xn=e=>p.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",width:"100",viewBox:"0 0 100 16.705"},e),p.createElement("path",{d:"M0 .232h3.852q1.972 0 2.877.928.904.905.904 2.807v.65q0 1.253-.417 2.042-.395.789-1.23 1.137v.046q1.903.65 1.903 3.388v1.392q0 1.879-.998 2.877-.974.974-2.877.974H0zm3.55 6.612q.766 0 1.137-.394.394-.394.394-1.323v-.904q0-.882-.325-1.277-.301-.394-.974-.394h-1.23v4.292zm.464 7.309q.673 0 .998-.348.324-.371.324-1.253v-1.415q0-1.114-.394-1.532-.371-.44-1.253-.44H2.552v4.988zM13.086 16.705q-1.856 0-2.83-1.044-.975-1.067-.975-3.04V.232h2.552v12.576q0 .836.325 1.207.348.371.974.371.627 0 .952-.371.348-.371.348-1.207V.232h2.459v12.39q0 1.972-.974 3.04-.975 1.043-2.831 1.043zM18.7.232h2.553v13.921h4.2v2.32H18.7zM26.682.232h2.552v13.921h4.2v2.32h-6.752zM38.376.232h3.643l1.624 11.624h.046L45.313.232h3.643v16.241h-2.413V4.176h-.046L44.64 16.473h-2.134L40.65 4.176h-.047v12.297h-2.227zM54.548 16.705q-1.88 0-2.877-1.067-.998-1.067-.998-3.016V4.083q0-1.949.998-3.016Q52.668 0 54.548 0q1.879 0 2.877 1.067.997 1.067.997 3.016v8.539q0 1.949-.997 3.016-.998 1.067-2.877 1.067zm0-2.32q1.322 0 1.322-1.6V3.92q0-1.601-1.322-1.601-1.323 0-1.323 1.6v8.864q0 1.601 1.323 1.601zM60.14.232h3.201l2.483 9.721h.046V.232h2.274v16.241h-2.622L62.46 4.617h-.046v11.856h-2.274zM70.046.232H72.6v16.241h-2.553zM76.497 2.552h-2.669V.232h7.889v2.32h-2.668v13.921h-2.552zM86.543 16.705q-1.88 0-2.877-1.067-.998-1.067-.998-3.016V4.083q0-1.949.998-3.016T86.543 0q1.88 0 2.877 1.067.998 1.067.998 3.016v8.539q0 1.949-.998 3.016t-2.877 1.067zm0-2.32q1.322 0 1.322-1.6V3.92q0-1.601-1.322-1.601-1.323 0-1.323 1.6v8.864q0 1.601 1.323 1.601zM92.135.232h3.781q1.973 0 2.877.928.905.905.905 2.807v.998q0 2.529-1.67 3.202v.046q.928.279 1.3 1.137.394.859.394 2.297v2.854q0 .696.046 1.137.046.418.232.835h-2.599q-.139-.394-.185-.742-.047-.348-.047-1.253v-2.97q0-1.114-.37-1.555-.349-.44-1.23-.44h-.882v6.96h-2.552zm3.48 6.96q.765 0 1.137-.394.394-.394.394-1.323V4.223q0-.882-.325-1.277-.301-.394-.974-.394h-1.16v4.64z"})),Cn=e=>window.btoa(e),Sn=e=>window.atob(e),wn={encode:Cn,decode:Sn,encodeJSON:e=>Cn(Sa.maybeStringify(e)),decodeJSON:e=>Sa.maybeParse(Sn(e))},Dn={queryParamName:"share",shareToken:ge.parse(window.location.search).share},Pn=()=>{const{enqueueSnackbar:e}=be();return e};var jn,Jn;(Jn=jn||(jn={}))[Jn.WORKSPACE=0]="WORKSPACE",Jn[Jn.SINGLE_JOB=1]="SINGLE_JOB";const $n=()=>{const e=Pn();return Ee(v.exports.useCallback(((t,a,n)=>{if(!t(Ia))return;const r=wn.encodeJSON(In(t,n)),l=ge.stringifyUrl({url:window.location.href,query:{[Dn.queryParamName]:r}});he(l),e("Copied to the clipboard",{variant:"success",autoHideDuration:1e3})}),[]))},In=(e,t)=>{const a=e(Oa),n=e(Ma);switch(t[0]){case 0:return{page:e(Na),queue:a,queueLabel:n,status:e(_a),order:e(za),jobId:e(Ba),dataSearch:e(Ta)};case 1:return{queue:a,queueLabel:n,jobId:t[1],page:0,status:e(_a)}}},Nn=m(d(((e,t)=>({screen:"jobs",changeScreen:t=>e({screen:t}),toggleScreen:()=>e({screen:"jobs"===t().screen?"metrics":"jobs"})})),{name:`${Kt}active-screen`})),On="https://github.com/s-r-x/bull-monitor",Mn=h((e=>({appBar:{zIndex:e.zIndex.drawer+1},menuButton:{marginRight:e.spacing(.5),[e.breakpoints.up("md")]:{display:"none"}},right:{display:"flex",alignItems:"center"}})));var _n=v.exports.memo((function(){const e=ve(),{queries:{getRedisInfo:t}}=dn(),a=v.exports.useCallback((()=>{e.getQueryData(Ya)||e.prefetchQuery(Ya,t)}),[]),n=Mn(),r=Xt((e=>e.toggle)),l=yn((e=>e.open)),o=qn((e=>e.open)),s=(()=>{const e=$n();return v.exports.useCallback((()=>{e([0])}),[e])})(),{screen:i,toggleScreen:u}=Nn();return p.createElement(fe,{position:"fixed",className:n.appBar},p.createElement(ye,null,p.createElement(X,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:r,className:n.menuButton,size:"large"},p.createElement(qe,null)),p.createElement(xn,{fill:"white",width:"130"}),p.createElement(ke,{className:n.right,marginLeft:"auto"},p.createElement(U,{title:"Github repository"},p.createElement(X,{href:On,target:"_blank",component:"a",color:"inherit",size:"large"},p.createElement(xe,null))),p.createElement(U,{title:"Redis info"},p.createElement(X,{onMouseEnter:a,onClick:o,"aria-label":"redis info",size:"large"},p.createElement(kn,{width:"24"}))),p.createElement(U,{title:"Share active workspace"},p.createElement(X,{onClick:s,color:"inherit","aria-label":"share active workspace",size:"large"},p.createElement(Ce,null))),p.createElement(U,{title:"jobs"===i?"Metrics":"Jobs"},p.createElement(X,{color:"inherit",onClick:u,size:"large"},"jobs"===i?p.createElement(Se,null):p.createElement(we,null))),p.createElement(U,{title:"Settings"},p.createElement(X,{onClick:l,color:"inherit","aria-label":"settings",size:"large"},p.createElement(De,null))))))}));const zn={deepPurple:C,deepOrange:je,blue:x,indigo:Je,pink:$e,teal:Ie,amber:Ne,red:q,lightBlue:Oe,lightGreen:Me,blueGrey:_e,brown:ze,grey:S,cyan:w,yellow:Be},Bn=Object.keys(zn),Tn=m(d((e=>({palette:"deepPurple",theme:"dark",changeTheme:t=>e({theme:t}),toggleTheme:()=>e((e=>({theme:"light"===e.theme?"dark":"light"}))),changePalette:t=>e({palette:t})})),{name:`${Kt}theme`}));function Fn(){const[e,t,a,n]=Tn((e=>[e.theme,e.palette,e.changeTheme,e.changePalette]),ce);return p.createElement("div",null,p.createElement(Y,{margin:"normal",value:e,onChange:e=>a(e.target.value),fullWidth:!0,variant:"outlined",select:!0,id:"appearance_theme",label:"Theme"},p.createElement(te,{value:"light"},"Light"),p.createElement(te,{value:"dark"},"Dark")),p.createElement(Y,{margin:"normal",variant:"outlined",value:t,onChange:e=>n(e.target.value),fullWidth:!0,select:!0,id:"appearance_palette",label:"Theme"},Bn.map((e=>p.createElement(te,{key:e,value:e},e)))))}function Qn(){const{confirmDangerousActions:e,toggleConfirmDangerousActions:t,groupQueuesByPrefix:a,toggleGroupQueuesByPrefix:n,expandJobData:r,expandJobStackTrace:l,expandJobReturnValue:o,toggleExpandJobData:s,toggleExpandJobStackTrace:i,toggleExpandJobReturnValue:u}=ka();return p.createElement(p.Fragment,null,p.createElement("div",null,p.createElement(Te,{margin:"dense"},p.createElement(Fe,{control:p.createElement(Qe,{checked:e,onChange:t}),label:"Confirm dangerous actions"})),p.createElement(Te,{margin:"dense"},p.createElement(Fe,{control:p.createElement(Qe,{checked:a,onChange:n}),label:"Group queues by prefix"}))),p.createElement("div",null,p.createElement(Te,{margin:"dense"},p.createElement(Fe,{control:p.createElement(Qe,{checked:r,onChange:s}),label:"Expand job's data by default"})),p.createElement(Te,{margin:"dense"},p.createElement(Fe,{control:p.createElement(Qe,{checked:o,onChange:u}),label:"Expand job's return value by default"})),p.createElement(Te,{margin:"dense"},p.createElement(Fe,{control:p.createElement(Qe,{checked:l,onChange:i}),label:"Expand job's stacktrace return value by default"}))))}const Ln=m(d((e=>({keyMap:"default",theme:"material",tabSize:2,changeTabSize:t=>e({tabSize:t}),changeKeyMap:t=>e({keyMap:t}),changeTheme:t=>e({theme:t})})),{name:`${Kt}code-editor`})),Wn=["material","solarized","monokai","dracula"],An=["vim","emacs","default","sublime"],Rn=[2,4,8];function Vn(){const[e,t,a,n,r,l]=Ln((e=>[e.theme,e.changeTheme,e.keyMap,e.changeKeyMap,e.tabSize,e.changeTabSize]),ce);return p.createElement("div",null,p.createElement(Y,{margin:"normal",value:e,onChange:e=>t(e.target.value),variant:"outlined",fullWidth:!0,select:!0,id:"editor-settings_theme",label:"Theme"},Wn.map((e=>p.createElement(te,{key:e,value:e},e)))),p.createElement(Y,{margin:"normal",value:a,onChange:e=>n(e.target.value),variant:"outlined",fullWidth:!0,select:!0,id:"editor-settings_key-map",label:"Key map"},An.map((t=>p.createElement(te,{key:e,value:t},t)))),p.createElement(Y,{margin:"normal",value:r,variant:"outlined",onChange:e=>l(Number(e.target.value)),fullWidth:!0,select:!0,id:"editor-settings_tab-size",label:"Tab size"},Rn.map((t=>p.createElement(te,{key:e,value:t},t)))))}const Gn=[0,1e3,3e3,5e3,1e4,3e4,6e4,6e5,18e5];function Hn(){const{pollingInterval:e,changePollingInterval:t,shouldFetchData:a,toggleShouldFetchData:n,textSearchPollingDisabled:r,toggleTextSearchPollingDisabled:l}=pn();return p.createElement("div",null,p.createElement(Y,{variant:"outlined",margin:"normal",value:e,onChange:e=>t(Number(e.target.value)),fullWidth:!0,select:!0,id:"network__polling-interval",label:"Polling Interval"},Gn.map((e=>p.createElement(te,{key:e,value:e},e?Le(e,{long:!0}):"Disable")))),p.createElement(Te,{margin:"dense"},p.createElement(Fe,{control:p.createElement(Qe,{checked:a,onChange:n}),label:"Fetch and render data"})),p.createElement(Te,{margin:"dense"},p.createElement(Fe,{control:p.createElement(Qe,{checked:r,onChange:l}),label:"Disable jobs polling while performing a text search"})))}const Kn=({children:e})=>p.createElement(ke,{marginBottom:2.5},e),Yn=({children:e})=>p.createElement(B,{style:{marginBottom:"-5px"},variant:"h6"},e),Un=()=>{const e=yn((e=>e.close));return p.createElement(p.Fragment,null,p.createElement(Ae,null,p.createElement(Kn,null,p.createElement(Yn,null,"Appearance"),p.createElement(Fn,null)),p.createElement(Kn,null,p.createElement(Yn,null,"Network"),p.createElement(Hn,null)),p.createElement(Kn,null,p.createElement(Yn,null,"Text editor"),p.createElement(Vn,null)),p.createElement(Kn,null,p.createElement(Yn,null,"Preferences"),p.createElement(Qn,null))),p.createElement(Re,null,p.createElement(E,{color:"inherit",onClick:e},"Close")))};function Xn(){const[e,t]=yn((e=>[e.isOpen,e.close]),ce);return p.createElement(We,{open:e,onClose:t},p.createElement(Un,null))}const Zn=h({root:{width:400,"@media(max-width: 440px)":{width:"auto"}},keyValueRoot:{display:"flex",justifyContent:"space-between"}}),er=({k:e,v:t})=>{const a=Zn();return p.createElement(N,{divider:!0},p.createElement(z,null,p.createElement(ke,{className:a.keyValueRoot},p.createElement("span",null,e),p.createElement("span",null,t))))},tr=()=>{const{queries:{getRedisInfo:e}}=dn(),t=Zn(),a=qn((e=>e.close)),n=gn(),{data:r,status:l,refetch:o}=se(Ya,e,{refetchInterval:n,select:e=>null==e?void 0:e.redisInfo}),s=v.exports.useMemo((()=>r?[["Used memory",r.used_memory_human],["Peak Used memory",r.used_memory_peak_human],["Total memory",r.total_system_memory_human],["Connected clients",r.connected_clients],["Blocked clients",r.blocked_clients],["Uptime",Le(1e3*Number(r.uptime_in_seconds),{long:!0})],["CPU time (minutes)",r.used_cpu_sys],["Fragmentation ratio",r.mem_fragmentation_ratio],["Version",r.redis_version],["Mode",r.redis_mode],["OS",r.os],["Port",r.tcp_port]].filter((([,e])=>!I(e))):[]),[r]);return p.createElement(p.Fragment,null,p.createElement(Ae,{className:t.root},p.createElement(aa,{status:l,refetch:o},p.createElement(H,{dense:!0},s.map((([e,t],a)=>p.createElement(er,{key:a,k:e,v:t})))))),p.createElement(Re,null,p.createElement(E,{color:"inherit",onClick:a},"Close")))};function ar(){const[e,t]=qn((e=>[e.isOpen,e.close]),ce);return p.createElement(We,{open:e,onClose:t},p.createElement(tr,null))}const nr=h((e=>({root:{marginBottom:e.spacing(1),padding:e.spacing(1),paddingBottom:0},chips:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap",marginBottom:e.spacing(1),"& > *":{margin:e.spacing(.5)},[e.breakpoints.down("xl")]:{maxWidth:"100%",overflowX:"auto",flexWrap:"nowrap","-webkit-overflow-scrolling":"touch"}}})));function rr(){const e=Ve(ja),[t,a]=V(Pa),n=Ve(Ja),r=G(Fa),l=Ve(Oa),o=Ve(Ma),s=G(La),i=nr();return p.createElement(Ge,{className:i.root},p.createElement("div",{className:i.chips},e.map((({id:e,queueLabel:r})=>p.createElement(D,{color:e===t?"primary":"default",onDelete:n>1?()=>s(e):void 0,onClick:()=>a(e),key:e,label:r}))),n<Da&&p.createElement(X,{onClick:()=>r({queue:l,queueLabel:o}),"aria-label":"Add workspace",size:"small"},p.createElement(He,null))))}const lr=h((e=>({root:{display:"flex",minHeight:"100vh"},toolbar:e.mixins.toolbar,content:{display:"flex",flexDirection:"column",maxWidth:"100%",[e.breakpoints.up("md")]:{maxWidth:"calc(100% - var(--drawer-width) - 1px)"},flexGrow:1,padding:e.spacing(1)}}))),or=e=>{const t=lr();(()=>{var e,t,a,n;const r=Ve(Ja),l=G(Fa),{data:o}=hn(),s=null==(t=null==(e=null==o?void 0:o.queues)?void 0:e[0])?void 0:t.id,i=null==(n=null==(a=null==o?void 0:o.queues)?void 0:a[0])?void 0:n.name;v.exports.useEffect((()=>{!r&&s&&i&&l({queue:s,queueLabel:i})}),[s,i,r])})();const a=Xt((e=>e.defaultWidth)),n=Ve(Oa),r={"--drawer-width":a+"px"};return p.createElement("div",{style:r,className:t.root},p.createElement(Ke,null),p.createElement(_n,null),p.createElement(fn,null),p.createElement("main",{className:t.content},p.createElement("div",{className:t.toolbar}),n&&p.createElement(p.Fragment,null,p.createElement(rr,null),e.children)),p.createElement(Xn,null),p.createElement(ar,null))},sr=m((e=>({jobIdentity:null,isOpen:!1,open:t=>e({isOpen:!0,jobIdentity:t}),close:()=>e({isOpen:!1})}))),ir=m((e=>({jobIdentity:null,isOpen:!1,open:t=>e({isOpen:!0,jobIdentity:t}),close:()=>e({isOpen:!1})}))),ur=m((e=>({isLocked:!1,unlock:()=>e({isLocked:!1}),lock:()=>e({isLocked:!0}),toggle:()=>e((e=>({isLocked:!e.isLocked})))}))),cr=()=>{(()=>{const[e,t]=ur((e=>[e.lock,e.unlock]),ce);v.exports.useEffect((()=>{const a=a=>{a?e():t()},n=sr.subscribe(a,(e=>e.isOpen)),r=ir.subscribe(a,(e=>e.isOpen));return()=>{n(),r()}}),[])})()},mr=Dn.shareToken,dr=e=>{const[t,a]=v.exports.useState(!mr),n=G(Fa);return v.exports.useEffect((()=>{if(!t){if("string"==typeof mr){const e=wn.decodeJSON(mr);Ye(e)&&(n(e),window.history.replaceState(null,document.title,window.location.pathname))}a(!0)}}),[t]),t?e.children:null},pr=e=>{const t=(()=>{const[e,t]=Tn((e=>[e.theme,e.palette]));return v.exports.useMemo((()=>Pe({palette:{primary:zn[t],secondary:q,mode:e}})),[e,t])})();return p.createElement(Ue,{injectFirst:!0},p.createElement(Xe,{theme:t},e.children))},gr=e=>{const{data:t}=hn();return v.exports.useMemo((()=>{var a;return null==(a=null==t?void 0:t.queues)?void 0:a.find((t=>t.id===e))}),[e,t])};var br=v.exports.memo((({className:e})=>{const{search:t,onChange:a,onClear:n}=(()=>{const[e,t]=v.exports.useState(""),[a,n]=V(Ta),r=G(Qa),l=v.exports.useCallback((()=>{r(),t("")}),[]);v.exports.useEffect((()=>{o.current||t(a)}),[a]);const o=v.exports.useRef(!1);return{onClear:l,search:e,onChange:v.exports.useMemo((()=>{const e=Ze((e=>{o.current=!1,n(e)}),250);return({target:{value:a}})=>{o.current=!0,t(a),e(a)}}),[])}})();return p.createElement(Y,{className:e,value:t,onChange:a,label:"Search",variant:"outlined",id:"jobs-filters_data-search-key",autoComplete:"off",size:"small",InputProps:{endAdornment:p.createElement(U,{title:"Clear"},p.createElement(X,{onClick:n,size:"small"},p.createElement(et,{fontSize:"small"})))}})}));function Er(e){const t=Ut+e.persistKey,[a,n]=v.exports.useState((()=>!localStorage.getItem(t)));return a?p.createElement(b,{severity:"info",className:e.className,onClose:()=>{localStorage.setItem(t,"!"),n(!1)}},e.tip):null}const hr=({className:e})=>{const t=p.createElement(p.Fragment,null,"Search is powered by"," ",p.createElement("a",{target:"__blank",href:"https://docs.jsonata.org/overview.html"},"jsonata"),". Check out the"," ",p.createElement("a",{target:"__blank",href:"https://github.com/s-r-x/bull-monitor/blob/main/search-examples.md"},"examples"),".");return p.createElement(Er,{className:e,persistKey:"data-text-search-v3",tip:t})},vr=h((e=>({root:{marginBottom:e.spacing(1),padding:e.spacing(1)},statuses:{display:"flex",justifyContent:"flex-start",maxWidth:"100%",overflowX:"auto",flexWrap:"nowrap",marginBottom:e.spacing(1),"-webkit-overflow-scrolling":"touch","& > *":{margin:e.spacing(.5)}},count:{width:"auto !important",backgroundColor:"transparent !important",display:"flex",alignItems:"center"},textFields:{display:"flex",flexWrap:"wrap",marginBottom:e.spacing(1),"& > *":{marginRight:e.spacing(1),marginTop:e.spacing(1)}},sortField:{minWidth:"90px"},dataSearchField:{flex:1,minWidth:"300px"},dataSearchTip:{marginBottom:e.spacing(1)}})));function fr(){const e=vr(),t=(()=>{const e=Ve(Oa),t=gr(e),[a,n]=V(_a);return v.exports.useMemo((()=>(null==t?void 0:t.jobsCounts)?Object.entries(J(t.jobsCounts,I)).map((([e,t])=>({label:e,value:t,onClick:()=>n(e),isActive:e===a}))):[]),[t,a])})(),[a,n]=V(Ba),[r,l]=V(za);return p.createElement(Ge,{className:e.root},p.createElement("div",{className:e.statuses},t.map((({value:t,label:a,isActive:n,onClick:r},l)=>p.createElement(D,{classes:{avatar:e.count},avatar:p.createElement("div",null,t),key:l,onClick:r,color:n?"primary":"default",label:a})))),p.createElement(hr,{className:e.dataSearchTip}),p.createElement("div",{className:e.textFields},p.createElement(Y,{value:a,onChange:e=>n(e.target.value),label:"Job ID",variant:"outlined",id:"jobs-filters_id",size:"small"}),p.createElement(Y,{variant:"outlined",size:"small",className:e.sortField,value:r,onChange:e=>{l(e.target.value)},select:!0,label:"Order",id:"jobs-filters_order"},p.createElement(te,{value:ia.Desc},"DESC"),p.createElement(te,{value:ia.Asc},"ASC")),p.createElement(br,{className:e.dataSearchField})))}const yr=(e,t="YYYY-MM-DD HH:mm:ss")=>e?tt(e).format(t):null;class qr extends Error{}const kr=()=>{const e=at();return t=>c(this,null,(function*(){try{yield e(i(s({},t),{confirmationButtonProps:{color:"inherit"},cancellationButtonProps:{color:"inherit"}}))}catch(a){throw new qr}}))};function xr(e){const t=ka((e=>e.confirmDangerousActions)),a=kr(),n=Pn(),r=ve();return nt(e.mutation,{onSuccess(t,a){e.toast&&n(e.toast,{variant:"success",autoHideDuration:2e3}),e.invalidateSharedQueries&&(r.invalidateQueries(Ka),r.invalidateQueries(Va)),e.onSuccess&&e.onSuccess(t,a)},onMutate(){return c(this,null,(function*(){if(t&&e.confirm)return yield a(e.confirm)}))},onError(e){e instanceof qr||n("Error. Check console for details",{variant:"error",autoHideDuration:2e3})}})}const Cr=h((e=>({root:{backgroundColor:"#282C34",padding:e.spacing(1),color:"#fff",maxHeight:"200px",overflowY:"auto",margin:0}}))),Sr=e=>{const t=Cr();return p.createElement("pre",{className:rt([t.root,e.className])},e.children)},wr=h((e=>({root:{overflowX:"auto"},stepper:{padding:0,whiteSpace:"nowrap"},text:{marginTop:e.spacing(2),maxWidth:"800px"}})));function Dr({job:e}){const t=wr(),a=yr(e.timestamp),n=yr(e.processedOn),r=e.delay,l=e.timestamp&&r?e.timestamp+r:null,o=yr(l),s=yr(e.finishedOn),i=(({job:e,delayTimestamp:t})=>{const a=Boolean(t);if([ra.Completed,ra.Failed].includes(e.status))return 10;if(e.status===ra.Active)return a?2:1;if(e.status===ra.Delayed){if(t&&e.timestamp){const a=tt();return tt(e.timestamp+t).isBefore(a)?2:1}return 1}return 1})({job:e,delayTimestamp:l}),u=e.status===ra.Failed,c=u?e.failedReason:e.returnValue;return p.createElement(ke,{className:t.root,p:1},p.createElement(lt,{orientation:"horizontal",className:t.stepper,activeStep:i},p.createElement(ot,null,p.createElement(st,null,p.createElement(B,{variant:"button"},"Queued"),p.createElement(B,{variant:"body2"},a))),o&&p.createElement(ot,null,p.createElement(st,null,p.createElement(B,{variant:"button"},"Delayed"),p.createElement(B,{variant:"body2"},o))),p.createElement(ot,null,p.createElement(st,null,p.createElement(B,{variant:"button"},"Processed"),n&&p.createElement(B,{variant:"body2"},n))),p.createElement(ot,null,p.createElement(st,{error:u},p.createElement(B,{variant:"button"},u?"Failed":"Finished"),s&&p.createElement(B,{variant:"body2"},s)))),c&&p.createElement(Sr,{className:t.text},c),e.opts&&p.createElement(Sr,{className:t.text},e.opts))}const Pr=()=>{const{queries:e}=dn();return xr({mutation:e.getJobsForExport,onSuccess({jobs:e}){const t=e.map((e=>i(s({},e),{opts:Sa.maybeParse(e.opts),data:Sa.maybeParse(e.data),returnValue:Sa.maybeParse(e.returnValue)}))),a=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});it.saveAs(a,"bull-jobs.json")}})},jr=m((e=>({data:"{}",options:"{}",name:"",isOpen:!1,open:()=>e({isOpen:!0}),close:()=>e({isOpen:!1}),closeAndClearInput:()=>e({isOpen:!1,data:"{}",options:"{}",name:""}),setInputAndOpen:t=>{const a=Sa.maybeParse(t.options),n=a&&Ye(a)?Sa.maybeStringify(ut(a,"timestamp",2)):"";e({name:t.name||"",data:t.data||"",options:n,isOpen:!0})},changeData:t=>e({data:t}),changeOptions:t=>e({options:t}),changeName:t=>e({name:t})}))),Jr=({job:e,queue:t,readonly:a})=>{const{mutations:n}=dn(),r=sr((e=>e.open)),l=jr((e=>e.setInputAndOpen)),o=ir((e=>e.open)),s=`${e.id}-info-popover`,i=p.useRef(null),[u,c,m]=((e=!1)=>{const[t,a]=v.exports.useState(e);return[t,v.exports.useCallback((()=>{a((e=>!e))}),[]),a]})(),[d,g]=p.useState(null),b=(()=>{const e=$n();return v.exports.useCallback((t=>{e([1,t])}),[e])})(),E=()=>g(null),h=xr({mutation:n.removeJob,confirm:{description:"Delete job"},invalidateSharedQueries:!0,toast:"Job has been removed"}),f=xr({mutation:n.moveJobToCompleted,toast:"Moved to completed",invalidateSharedQueries:!0}),y=Pr(),q=xr({mutation:n.promoteJob,toast:"Promoted",invalidateSharedQueries:!0}),k=xr({mutation:n.discardJob,toast:"Discarded"}),x=xr({mutation:n.moveJobToFailed,toast:"Moved to failed",invalidateSharedQueries:!0}),C=xr({mutation:n.retryJob,toast:"Retried",invalidateSharedQueries:!0}),S={queue:t,id:e.id};return p.createElement(p.Fragment,null,p.createElement(U,{title:"Data"},p.createElement(X,{disabled:a,size:"small",onClick:()=>r(S),color:"primary"},p.createElement(ct,null))),p.createElement(U,{title:"Delete job"},p.createElement(X,{disabled:a,size:"small",onClick:()=>h.mutate(S),color:"secondary"},p.createElement(mt,null))),p.createElement(X,{"aria-haspopup":"true","aria-owns":s,ref:i,onClick:c,size:"small"},p.createElement(dt,null)),p.createElement(pt,{id:s,onClose:()=>m(!1),open:u,anchorEl:i.current,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},p.createElement(Dr,{job:e})),p.createElement(U,{title:"More"},p.createElement(X,{size:"small",onClick:e=>g(e.currentTarget)},p.createElement(gt,null))),p.createElement(ee,{anchorEl:d,open:Boolean(d),onClose:E,onClick:E},e.status===ra.Completed&&p.createElement(te,{disabled:a,onClick:()=>l({name:e.name,data:e.data,options:e.opts})},"Queue again"),e.status===ra.Failed&&p.createElement(te,{disabled:a,onClick:()=>C.mutate(S)},"Retry"),e.status===ra.Waiting&&p.createElement(te,{disabled:a,onClick:()=>f.mutate(S)},"Move to completed"),e.status===ra.Waiting&&p.createElement(te,{disabled:a,onClick:()=>x.mutate(S)},"Move to failed"),p.createElement(te,{onClick:()=>y.mutate({queue:t,ids:[e.id]})},"Save as JSON"),p.createElement(te,{onClick:()=>b(e.id)},"Share"),e.status===ra.Delayed&&p.createElement(te,{disabled:a,onClick:()=>q.mutate(S)},"Promote"),p.createElement(te,{disabled:a,onClick:()=>k.mutate(S)},"Discard"),p.createElement(te,{onClick:()=>o(S)},"Logs")))},$r=e=>{const{children:t,header:a,textClassName:n,defaultExpanded:r=!0}=e;return v.exports.createElement("div",null,v.exports.createElement(bt,{defaultExpanded:r},v.exports.createElement(Et,{expandIcon:v.exports.createElement(ht,null)},v.exports.createElement(B,null,a)),v.exports.createElement(vt,null,v.exports.createElement(Sr,{className:n},t))))},Ir=h((e=>({rowWithExtra:{"& td":{borderBottom:"none"}},extraCell:{paddingTop:0},extraOneCol:{display:"grid",gridTemplateColumns:"1fr"},extraTwoCol:{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:e.spacing(1),[e.breakpoints.down("xl")]:{gridTemplateColumns:"1fr"}},stacktrace:{backgroundColor:e.palette.error.main}})));var Nr=p.memo((({job:e,queue:t,isSelected:a,toggleSelected:n,removeSelected:r,readonly:l})=>{const o=ka(),s=yr(e.timestamp),i=Ir();((e,t,a)=>{const n=v.exports.useRef(e),r=v.exports.useRef(t);n.current=e,r.current=t,v.exports.useEffect((()=>()=>{r.current&&n.current&&a(n.current)}),[])})(e.id,a,r);const u=yr(e.delay&&e.timestamp?e.timestamp+e.delay:null),c=!!e.data&&"{}"!==e.data,m=!A(e.stacktrace),d=!A(e.returnValue),g=c||m||d;return p.createElement(p.Fragment,null,p.createElement(ft,{className:g?i.rowWithExtra:void 0},p.createElement(yt,{padding:"checkbox"},p.createElement(qt,{onChange:()=>n(e.id),checked:a})),p.createElement(yt,null,p.createElement(Jr,{readonly:l,job:e,queue:t})),p.createElement(yt,null,e.id),p.createElement(yt,null,p.createElement(Ea,{status:e.status})),p.createElement(yt,null,e.name),p.createElement(yt,null,s),p.createElement(yt,null,u),p.createElement(yt,null,e.processingTime?Le(e.processingTime):null),p.createElement(yt,null,e.attemptsMade),p.createElement(yt,null,e.progress)),g&&p.createElement(ft,null,p.createElement(yt,{className:i.extraCell,colSpan:12},p.createElement("div",{className:[c,m,d].filter(Boolean).length>1?i.extraTwoCol:i.extraOneCol},c&&p.createElement($r,{defaultExpanded:o.expandJobData,header:"Job Data"},e.data),d&&p.createElement($r,{defaultExpanded:o.expandJobReturnValue,header:"Return Value"},e.returnValue),m&&p.createElement($r,{defaultExpanded:o.expandJobStackTrace,textClassName:i.stacktrace,header:"Stacktrace"},e.stacktrace.join("\n\n"))))))}));const Or={perPageOptions:[10,25,50,75,100,250,500]},Mr=m(d((e=>({perPage:Or.perPageOptions[1],changePerPage:t=>e({perPage:t})})),{whitelist:["perPage"],name:`${Kt}pagination`})),_r=h((e=>({root:{position:"sticky",bottom:0,backgroundColor:e.palette.background.paper,zIndex:2,borderTop:"1px solid "+("dark"===e.palette.mode?"#515151":"#e0e0e0"),borderBottomRightRadius:"4px",borderBottomLeftRadius:"4px"}})));var zr=v.exports.memo((()=>{const e=_r(),[t,a]=V(Na),{perPage:n,changePerPage:r}=Mr(),l=(()=>{var e;const t=Ve(Ba),a=Ve(_a),n=Ve(Oa),r=null==(e=gr(n))?void 0:e.jobsCounts;return!r||t||a===ra.Stuck||a===ra.Unknown?0:a in r?r[a]:0})();return p.createElement(kt,{className:e.root,rowsPerPageOptions:Or.perPageOptions,component:"div",count:l,rowsPerPage:n,page:t,labelRowsPerPage:"Per page",onPageChange:(e,t)=>a(t),onRowsPerPageChange:e=>r(Number(e.target.value))})}));window.jsonlint=xt;const Br=h({root:{width:"100%",position:"relative"},utils:{position:"absolute",right:5,top:5,zIndex:2}}),Tr=e=>{const t=Br(),[a,n,r]=Ln((e=>[e.theme,e.keyMap,e.tabSize]),ce);return p.createElement("div",{className:t.root},p.createElement(Ct,{onBeforeChange:(t,a,n)=>{e.onChange&&e.onChange(n)},options:{autoCloseBrackets:!0,matchBrackets:!0,lineWrapping:!0,readOnly:e.readOnly,theme:a,tabSize:r,indentUnit:r,lint:!0,lineNumbers:!0,mode:"application/json",keyMap:n},value:e.value}),!e.readOnly&&e.value&&p.createElement("div",{className:t.utils,onClick:()=>{e.onChange&&e.value&&e.onChange(Sa.maybeStringify(Sa.maybeParse(e.value)))}},p.createElement(E,{color:"info",size:"small"},"Format")))},Fr=h((e=>({appBar:{position:"relative"},submitBtn:{marginLeft:e.spacing(1)},root:{padding:e.spacing(2),paddingBottom:0,"& .CodeMirror":{height:"calc(100vh - 100px)"}}}))),Qr=()=>{const e=ve(),t=Fr(),[a,n]=p.useState(),{queries:{getJobData:r},mutations:{updateJobData:l}}=dn(),[o,u]=sr((e=>[e.close,e.jobIdentity]),ce),c=[Ga,u],{status:m,refetch:d}=se(c,(()=>r(u)),{onSuccess:e=>{var t;n(null==(t=e.job)?void 0:t.data)},enabled:Boolean(u)}),g=xr({mutation:l,toast:"Job data has been updated",onSuccess(){const t={job:{data:a}};e.setQueryData(c,t),o()}});return p.createElement(p.Fragment,null,p.createElement(fe,{className:t.appBar},p.createElement(ye,null,p.createElement(X,{edge:"start",color:"inherit",onClick:o,"aria-label":"close",size:"large"},p.createElement(St,null)),p.createElement(E,{color:"inherit",className:t.submitBtn,onClick:()=>{g.mutateAsync(i(s({},u),{data:a}))}},"Update data"))),p.createElement("div",{className:t.root},p.createElement(aa,{status:m,refetch:d},p.createElement(Tr,{onChange:n,value:a}))))};function Lr(){const[e,t]=sr((e=>[e.isOpen,e.close]),ce);return p.createElement(We,{fullScreen:!0,open:e,onClose:t},p.createElement(Qr,null))}const Wr=h((e=>({root:{width:500,"@media(max-width: 540px)":{width:"auto"}},inputRoot:{display:"flex",alignItems:"center","& button":{marginLeft:e.spacing(1)}}}))),Ar=()=>{var e,t,a;const[n,r]=p.useState(""),l=Wr(),{queries:{getJobLogs:o},mutations:{createJobLog:u}}=dn(),[c,m]=ir((e=>[e.close,e.jobIdentity]),ce),d=!!(null==(e=gr(m.queue))?void 0:e.readonly),{status:g,refetch:b,data:h}=se([Ha,m],(()=>o(m)),{enabled:Boolean(m)}),v=xr({mutation:u,toast:"Created",onSuccess:()=>{b(),r("")}});return p.createElement(p.Fragment,null,p.createElement(Ae,{className:l.root},p.createElement("form",{"aria-disabled":d,onSubmit:e=>{e.preventDefault(),v.mutate(i(s({},m),{row:n}))},autoComplete:"off"},p.createElement("div",{className:l.inputRoot},p.createElement(Y,{disabled:d,fullWidth:!0,value:n,onChange:e=>r(e.target.value),required:!0,id:"job-log-input",label:"Log"}),p.createElement(E,{color:"inherit",disabled:d,type:"submit"},"submit"))),p.createElement(aa,{status:g,refetch:b},p.createElement(H,{dense:!0},null==(a=null==(t=null==h?void 0:h.job)?void 0:t.logs)?void 0:a.logs.map(((e,t)=>p.createElement(N,{divider:!0,disableGutters:!0,key:t},p.createElement(z,{primary:e}))))))),p.createElement(Re,null,p.createElement(E,{onClick:c},"Close")))};function Rr(){const[e,t]=ir((e=>[e.isOpen,e.close]),ce);return p.createElement(We,{open:e,onClose:t},p.createElement(Ar,null))}const Vr=m(((e,t)=>({selected:new Set,setJobs:t=>e({selected:new Set(t)}),addJob:a=>e({selected:new Set(t().selected).add(a)}),toggleJob:a=>{const{selected:n}=t();n.has(a)?(n.delete(a),e({selected:new Set(n)})):e({selected:new Set(n).add(a)})},removeJob:a=>{const n=new Set(t().selected);n.delete(a),e({selected:n})},clear:()=>{const{selected:a}=t();a.size>0&&e({selected:new Set})}})));function Gr({jobs:e}){var t;const[a,n,r]=Vr((e=>[e.selected,e.clear,e.setJobs]),ce),l=!A(e),o=null!=(t=null==e?void 0:e.length)?t:0,s=a.size>0&&a.size!==o,i=l&&a.size===o;return p.createElement(wt,null,p.createElement(ft,null,p.createElement(yt,{padding:"checkbox"},p.createElement(qt,{indeterminate:s,checked:i,onChange:(t,a)=>{a?e&&l&&r(null==e?void 0:e.map((e=>e.id))):n()}})),p.createElement(yt,{style:{minWidth:"172px"},width:"172"},"Actions"),p.createElement(yt,null,"ID"),p.createElement(yt,null,"Status"),p.createElement(yt,null,"Name"),p.createElement(yt,null,"Timestamp"),p.createElement(yt,null,"Delay"),p.createElement(yt,{width:"100"},"Time"),p.createElement(yt,{width:"100"},"Attempts"),p.createElement(yt,{width:"100"},"Progress")))}const Hr=m((e=>({isOpen:!1,open:()=>e({isOpen:!0}),close:()=>e({isOpen:!1})}))),Kr=h((e=>({root:{"& > *":{margin:e.spacing(.5)},"& > button:first-child":{marginLeft:0}}})));var Yr=v.exports.memo((()=>{const e=Kr(),[t,a]=p.useState(null);p.useState(null);const[n,r]=p.useState(null),[l,o]=ur((e=>[e.isLocked,e.toggle]),ce),u=Pr(),m=gn(),d=()=>{a(null)},g=()=>{r(null)},b=Ve(Oa),E=Ve(_a),h=Ve(Ba),v=Ve(Ta),{mutations:{pauseQueue:f,resumeQueue:y,emptyQueue:q,cleanQueue:k}}=dn(),x=gr(b),C=null==x?void 0:x.isPaused,S=!!(null==x?void 0:x.readonly),w=Hr((e=>e.open)),D=xr({mutation:f,toast:"Queue has been paused",invalidateSharedQueries:!0,confirm:{description:"Pause queue"},onSuccess:g}),P=xr({mutation:q,invalidateSharedQueries:!0,toast:"Queue has been emptied",confirm:{description:"Empty queue"},onSuccess:g}),j=xr({mutation:y,invalidateSharedQueries:!0,toast:"Queue has been resumed",onSuccess:g}),J=xr({mutation:k,toast:"Cleaned",invalidateSharedQueries:!0,confirm:{description:"Clean queue"}}),$=e=>c(this,null,(function*(){yield J.mutateAsync(i(s({},I),{status:e})),d()})),I={queue:b},N=jr((e=>e.open));return p.createElement("div",{className:e.root},p.createElement(U,{title:"Add job"},p.createElement(X,{onClick:N,disabled:S},p.createElement(He,null))),p.createElement(U,{title:"Clean"},p.createElement(X,{onClick:e=>{a(e.currentTarget)},color:"secondary",disabled:S,"aria-controls":"clean-queue-menu","aria-haspopup":"true"},p.createElement(mt,null))),p.createElement(ee,{id:"clean-queue-menu",anchorEl:t,open:Boolean(t),onClose:d},p.createElement(te,{onClick:()=>$(oa.Wait)},"Waiting"),p.createElement(te,{onClick:()=>$(oa.Active)},"Active"),p.createElement(te,{onClick:()=>$(oa.Completed)},"Completed"),p.createElement(te,{onClick:()=>$(oa.Delayed)},"Delayed"),p.createElement(te,{onClick:()=>$(oa.Failed)},"Failed"),p.createElement(te,{onClick:()=>$(oa.Paused)},"Paused")),p.createElement(U,{title:"Export jobs as JSON"},p.createElement(X,{onClick:()=>{u.mutate({queue:b,status:E,id:h,dataSearch:v})}},p.createElement(Dt,null))),p.createElement(U,{title:C?"Resume":"Pause"},p.createElement(X,{disabled:S,onClick:()=>{C?j.mutate(I):D.mutate(I)}},C?p.createElement(Pt,null):p.createElement(M,null))),p.createElement(X,{onClick:e=>{r(e.currentTarget)},disabled:S,"aria-controls":"more-queue-actions-menu","aria-haspopup":"true"},p.createElement(gt,null)),p.createElement(ee,{id:"more-queue-actions-menu",anchorEl:n,open:Boolean(n),onClose:g},m&&p.createElement(te,{onClick:()=>{o(),g()}},l?"Enable jobs polling":"Disable jobs polling"),(null==x?void 0:x.provider)===ca.Bull&&p.createElement(te,{onClick:w},"Remove jobs by pattern"),p.createElement(te,{onClick:()=>P.mutate(I)},"Empty")))}));const Ur=h((e=>({title:{marginRight:e.spacing(3)}})));function Xr(){var e;const t=Ve(Oa),a=!!(null==(e=gr(t))?void 0:e.readonly),n=Ur(),r=Ve(_a),{mutations:l}=dn(),[o,s]=Vr((e=>[e.selected,e.clear])),i=Pr(),u=o.size,c=xr({mutation:l.removeJobs,confirm:{description:"Delete selected jobs"},invalidateSharedQueries:!0,toast:"Jobs have been removed",onSuccess:s}),m=xr({mutation:l.retryJobs,confirm:{description:"Retry selected jobs"},invalidateSharedQueries:!0,toast:"Retried",onSuccess:s});return p.createElement(p.Fragment,null,p.createElement(B,{className:n.title,color:"inherit",variant:"subtitle1",component:"div"},u," selected"),r===ra.Failed&&p.createElement(U,{title:"Retry selected jobs"},p.createElement(X,{disabled:a,onClick:()=>m.mutate({queue:t,jobs:Array.from(o)}),size:"large"},p.createElement(jt,null))),p.createElement(U,{title:"Delete selected jobs"},p.createElement(X,{disabled:a,onClick:()=>c.mutate({queue:t,jobs:Array.from(o)}),color:"secondary",size:"large"},p.createElement(mt,null))),p.createElement(U,{title:"Save as JSON"},p.createElement(X,{onClick:()=>i.mutate({queue:t,ids:Array.from(o)}),size:"large"},p.createElement(Dt,null))))}function Zr(){const e=Vr((e=>e.selected)).size;return p.createElement(ye,null,e>0?p.createElement(Xr,null):p.createElement(Yr,null))}function el(){var e,t;const a=Ve(Oa),{data:n,status:r,refetch:l,error:o}=(()=>{const{queries:{getJobs:e}}=dn(),t=Ve(Na),a=Mr((e=>e.perPage)),n=Ve(_a),r=Ve(Oa),l=Ve(za),o=Ve(Ba),s=Ve(Ta),i=ur((e=>e.isLocked)),[u,c]=pn((e=>[e.shouldFetchData,e.textSearchPollingDisabled]),ce),m=gn();return se([Ka,{queue:r,perPage:a,page:t,status:n,order:l,id:o,dataSearch:s,shouldFetchData:u}],(()=>e({queue:r,limit:a,offset:t*a,status:n,order:l,id:o,fetchData:u,dataSearch:s})),{keepPreviousData:!0,enabled:Boolean(r),refetchInterval:!(i||c&&s)&&m})})(),[s,i,u]=Vr((e=>[e.selected,e.toggleJob,e.removeJob]),ce),c=!!(null==(e=gr(a))?void 0:e.readonly);return p.createElement(Ge,null,p.createElement(aa,{status:r,refetch:l,error:o},p.createElement(Zr,null),p.createElement(Jt,null,p.createElement($t,{size:"medium"},p.createElement(Gr,{jobs:null==n?void 0:n.jobs}),p.createElement(It,null,null==(t=null==n?void 0:n.jobs)?void 0:t.map((e=>p.createElement(Nr,{readonly:c,toggleSelected:i,removeSelected:u,isSelected:s.has(e.id),queue:a,key:e.id,job:e})))))),p.createElement(zr,null)),p.createElement(Lr,null),p.createElement(Rr,null))}const tl=h((e=>({label:{marginBottom:e.spacing(1)},formControl:{marginBottom:e.spacing(2)},appBar:{position:"relative"},submitBtn:{marginLeft:e.spacing(1)},form:{display:"flex",padding:e.spacing(2),paddingBottom:0,flexDirection:"column",[e.breakpoints.up("sm")]:{"& .CodeMirror":{height:"calc(100vh - 180px)"}}}}))),al=()=>{const e=tl(),t=Ve(Oa),{mutations:{createJob:a}}=dn(),{close:n,data:r,changeData:l,options:o,changeOptions:s,closeAndClearInput:i,name:u,changeName:c}=jr(),m=xr({mutation:a,toast:"Job has been created",onSuccess:i,invalidateSharedQueries:!0});return p.createElement(p.Fragment,null,p.createElement(fe,{className:e.appBar},p.createElement(ye,null,p.createElement(X,{edge:"start",color:"inherit",onClick:n,"aria-label":"close",size:"large"},p.createElement(St,null)),p.createElement(E,{className:e.submitBtn,disabled:m.isLoading,type:"submit",form:"create-job_form",color:"inherit"},"Create job"))),p.createElement("form",{className:e.form,onSubmit:e=>{e.preventDefault(),m.mutate({input:{queue:t,data:r,name:u,options:o}})},id:"create-job_form"},p.createElement(Y,{fullWidth:!0,variant:"outlined",value:u,size:"small",onChange:e=>c(e.target.value),id:"create-job_name",label:"Name",className:e.formControl}),p.createElement(Nt,{container:!0,spacing:2},p.createElement(Nt,{item:!0,xs:12,sm:6},p.createElement(Te,{fullWidth:!0},p.createElement(Ot,{className:e.label},"Data"),p.createElement(Tr,{value:r,onChange:l}))),p.createElement(Nt,{item:!0,xs:12,sm:6},p.createElement(Te,{fullWidth:!0},p.createElement(Ot,{className:e.label},"Options"),p.createElement(Tr,{value:o,onChange:s}))))))};function nl(){const[e,t]=jr((e=>[e.isOpen,e.close]),ce);return p.createElement(We,{fullScreen:!0,open:e,onClose:t},p.createElement(al,null))}const rl=h((e=>({container:{minWidth:320},formControl:{marginBottom:e.spacing(2)},form:{width:"100%"}}))),ll=()=>{const[e,t]=p.useState(""),a=rl(),n=Ve(Oa),{mutations:{removeJobsByPattern:r}}=dn(),l=Hr((e=>e.close)),o=xr({mutation:r,invalidateSharedQueries:!0,toast:"Jobs have been removed",onSuccess:l});return p.createElement(p.Fragment,null,p.createElement(Ae,{className:a.container},p.createElement("form",{onSubmit:t=>{t.preventDefault(),o.mutate({queue:n,pattern:e})},id:"remove-jobs_form",className:a.form},p.createElement(Y,{fullWidth:!0,variant:"outlined",value:e,onChange:e=>t(e.target.value),id:"remove-jobs_pattern",label:"Pattern",required:!0,className:a.formControl}))),p.createElement(Re,null,p.createElement(E,{color:"inherit",onClick:l},"Cancel"),p.createElement(E,{color:"inherit",disabled:o.isLoading,type:"submit",form:"remove-jobs_form"},"Submit")))};function ol(){const[e,t]=Hr((e=>[e.isOpen,e.close]),ce);return p.createElement(We,{open:e,onClose:t},p.createElement(ll,null))}var sl=v.exports.memo((()=>p.createElement(p.Fragment,null,p.createElement(fr,null),p.createElement(el,null),p.createElement(nl,null),p.createElement(ol,null))));const il=h((e=>({root:{padding:e.spacing(1),paddingLeft:0,overflow:"hidden",flex:1,[e.breakpoints.down("md")]:{display:"block",height:400}},tooltipLabel:{color:"black"}}))),ul={min:k[400],max:q[400],avg:x[400]},cl=e=>tt(e).format("YYYY-MM-DD HH:mm"),ml=e=>tt(e).format("YYYY-MM-DD HH:mm"),dl=e=>Le(e),pl=Object.values(ra).filter((e=>e!==ra.Stuck));var gl=v.exports.memo((({metrics:e})=>{const t=il(),a=ba();return p.createElement(Ge,{className:t.root},p.createElement(Mt,{width:"100%",height:"100%"},p.createElement(_t,{data:e,margin:{top:5,right:30,left:0,bottom:5}},p.createElement(zt,{interval:"preserveStartEnd",tick:{fontSize:14},dataKey:"timestamp",tickLine:!1,dy:7,tickFormatter:cl}),p.createElement(Bt,{tick:{fontSize:14},tickLine:!1}),p.createElement(Tt,{labelClassName:t.tooltipLabel,labelFormatter:ml}),p.createElement(Ft,null),pl.map((e=>p.createElement(Qt,{key:e,strokeWidth:2,isAnimationActive:!1,name:e,type:"monotone",stroke:a[e],dataKey:`counts.${e}`}))))))}));var bl=v.exports.memo((({metrics:e})=>{const t=il(),a=v.exports.useMemo((()=>e.filter((e=>!!e.processingTime))),[e]);return A(a)?p.createElement(b,{severity:"warning"},'No "processing time" metrics'):p.createElement(Ge,{className:t.root},p.createElement(Mt,{width:"100%",height:"100%"},p.createElement(_t,{data:a,margin:{top:5,right:30,left:0,bottom:5}},p.createElement(zt,{interval:"preserveStartEnd",tick:{fontSize:14},dataKey:"timestamp",tickLine:!1,dy:7,tickFormatter:cl}),p.createElement(Bt,{tick:{fontSize:14},tickLine:!1}),p.createElement(Tt,{labelClassName:t.tooltipLabel,labelFormatter:ml,formatter:dl}),p.createElement(Ft,null),p.createElement(Qt,{strokeWidth:2,isAnimationActive:!1,name:"Processing time(min)",type:"monotone",dataKey:"processingTimeMin",stroke:ul.min}),p.createElement(Qt,{strokeWidth:2,isAnimationActive:!1,name:"Processing time(max)",type:"monotone",dataKey:"processingTimeMax",stroke:ul.max}),p.createElement(Qt,{strokeWidth:2,isAnimationActive:!1,name:"Processing time(avg)",type:"monotone",dataKey:"processingTime",stroke:ul.avg}))))}));const El=h((e=>({root:{marginBottom:e.spacing(1),padding:e.spacing(1),"& > *":{margin:e.spacing(.5)}}}))),hl=()=>{var e;const{mutations:{clearMetrics:t,clearAllMetrics:a}}=dn(),n=ve(),r=Ve(Oa),l=!!(null==(e=gr(r))?void 0:e.readonly),o=xr({mutation:t,toast:"Cleared",confirm:{description:"Clear metrics"},onSuccess(){n.invalidateQueries(Ua)}}),s=xr({mutation:a,toast:"Cleared",confirm:{description:"Clear all metrics"},onSuccess(){n.invalidateQueries(Ua)}}),i=El();return p.createElement(Ge,{className:i.root},p.createElement(E,{disabled:l,onClick:()=>o.mutate({queue:r}),color:"secondary"},"Clear"),p.createElement(E,{disabled:l,onClick:()=>s.mutate(null),color:"secondary"},"Clear all"))},vl=h((e=>({grid:{flex:1,display:"flex",[e.breakpoints.down("md")]:{display:"block"}},gridItem:{flex:1,display:"flex",flexDirection:"column",[e.breakpoints.down("md")]:{display:"block"}}}))),fl=()=>{const{queries:{getQueueMetrics:e}}=dn(),t=vl(),a=Ve(Oa),n=gn(),{status:r,refetch:l,data:o,error:s}=se([Ua,{queue:a}],(()=>e({queue:a})),{refetchInterval:n,select:e=>{var t;return null!=(t=null==e?void 0:e.metrics)?t:[]}});return p.createElement(aa,{error:s,refetch:l,status:r},p.createElement(hl,null),A(o)?p.createElement(b,{severity:"warning"},"No metrics"):p.createElement(Nt,{className:t.grid,container:!0,spacing:1},p.createElement(Nt,{className:t.gridItem,item:!0,xs:12,sm:6},p.createElement(gl,{metrics:o})),p.createElement(Nt,{className:t.gridItem,item:!0,xs:12,sm:6},p.createElement(bl,{metrics:o}))))},yl=()=>{switch(Nn((e=>e.screen))){case"jobs":return p.createElement(sl,null);case"metrics":return p.createElement(fl,null);default:return null}},ql=new Lt;function kl(){return cr(),(()=>{const e=Ve(Ma);v.exports.useEffect((()=>{const t=document.querySelector("title");e&&t&&(t.textContent=e)}),[e])})(),p.createElement(dr,null,p.createElement(mn,null,p.createElement(pr,null,p.createElement(Wt,null,p.createElement(At,{maxSnack:3},p.createElement(Rt,{client:ql},p.createElement(En,null,p.createElement(or,null,p.createElement(yl,null)))))))))}Vt.render(p.createElement(p.StrictMode,null,p.createElement(kl,null)),document.getElementById("root"));
